# 👑 Git Master 전용 가이드

---

## 📜 Git Master의 역할

1.  **브랜치 보호:** `main`, `develop` 브랜치에 대한 직접적인 `push`를 방지하고, 브랜치 보호 규칙(Branch Protection Rule)을 설정합니다.
2.  **PR 리뷰 및 병합:** 팀원들의 PR을 리뷰하고, 코드 품질을 확인하며, 충돌이 없는지 확인 후 `Squash and Merge`로 병합합니다.
3.  **히스토리 관리:** `develop` 브랜치의 히스토리가 깔끔하게 유지되도록 관리합니다.
4.  **트러블슈팅:** 팀원들이 겪는 복잡한 Git 문제를 해결하고 지원합니다. (`revert`, `cherry-pick` 등)

---

## 🛠️ 주요 병합 및 관리 기술

### 1. PR 병합 (Squash and Merge)

* **원칙:** 모든 기능 브랜치는 `develop`으로 병합 시 **`Squash and Merge`**를 사용합니다.
* **이유:** `develop` 히스토리를 기능 단위로 깔끔하게 유지하기 위함입니다.
* **방법:** GitHub PR 페이지에서 "Merge" 버튼 드롭다운을 열어 "Squash and Merge"를 선택합니다.

### 2. PR 히스토리 정리 요청 (Interactive Rebase)

* 팀원의 PR에 불필요한 커밋(`chore: 오타 수정`, `fix: 또 수정`)이 너무 많아 리뷰가 어려울 경우, 팀원에게 `rebase -i`를 통해 커밋을 정리해달라고 요청할 수 있습니다.

* **팀원에게 가이드할 명령어:**
    ```bash
    # (예: 최근 3개의 커밋을 정리할 경우)
    git rebase -i HEAD~3
    ```
    * 에디터가 열리면, 맨 위 커밋만 `pick`으로 두고 나머지는 `s` (squash) 또는 `f` (fixup)로 변경하도록 안내합니다.
    * 이후 `push --force`가 필요함을 알립니다. (공유 브랜치가 아니므로 안전)
    * `git push origin dev/개인 브랜치 --force-with-lease` (더 안전한 강제 푸시)

### 3. `develop`에 잘못 병합된 기능 되돌리기 (`revert`)

* **상황:** PR이 병합되었으나, 심각한 버그가 발견되어 해당 기능 전체를 되돌려야 할 때.
* **절대 금지:** `git reset --hard` (이미 공유된 히스토리를 강제로 되돌리면 모든 팀원이 재앙을 맞봅니다.)
* **해결책:** `git revert`를 사용하여 "되돌렸다는 새로운 커밋"을 만듭니다.

    1.  `develop` 브랜치를 최신화합니다.
        ```bash
        git checkout develop
        git pull origin develop
        ```
    2.  되돌리려는 병합 커밋(Merge Commit)의 해시를 찾습니다. (GitHub `develop` 히스토리에서 확인)
    3.  `revert` 명령을 실행합니다. (병합 커밋은 `-m 1` 옵션이 필요합니다)
        ```bash
        # [merge-commit-hash]를 대상 커밋 해시로 변경
        git revert -m 1 [merge-commit-hash]
        ```
    4.  새롭게 생성된 "Revert..." 커밋을 `develop`에 푸시합니다.
        ```bash
        git push origin develop
        ```

### 4. 다른 브랜치의 특정 커밋만 가져오기 (`cherry-pick`)

* **상황:** `dev/hotfix` 브랜치에서 급한 버그 1개만 수정했는데, 이 커밋이 `develop` 브랜치에도 즉시 반영되어야 할 때.
* **해결책:** `git cherry-pick`을 사용합니다.

    1.  `develop` 브랜치로 이동합니다.
        ```bash
        git checkout develop
        git pull origin develop
        ```
    2.  가져오려는 커밋의 해시(예: `a1b2c3d`)를 `cherry-pick` 합니다.
        ```bash
        git cherry-pick a1b2c3d
        ```
    3.  충돌이 발생하면 해결하고, `push` 합니다.
        ```bash
        git push origin develop
        ```

---

## 🚨 Git Master 비상 대응 매뉴얼

### Case 1: 팀원이 `develop`에 강제 푸시(`force push`) 했습니다.

1.  **즉시 전파:** 모든 팀원에게 `git pull`을 중지하라고 알립니다.
2.  **GitHub 원격 복구:** GitHub 저장소의 `develop` 브랜치 히스토리를 확인하여 강제 푸시 직전의 커밋 해시(예: `e4d5f6g`)를 찾습니다.
3.  **로컬에서 강제 복구:**
    ```bash
    git checkout develop
    git reset --hard e4d5f6g
    ```
4.  **원격 저장소 강제 푸시:** (이 작업은 Git Master만 수행)
    ```bash
    git push origin develop --force
    ```
5.  **팀원 전파:** 모든 팀원에게 로컬 `develop`을 삭제하고 다시 받으라고 안내합니다.
    ```bash
    # (팀원용 가이드)
    git checkout main
    git branch -D develop
    git fetch origin
    git checkout -t origin/develop
    ```

### Case 2: 팀원이 `git reflog`로도 브랜치를 찾지 못합니다. (로컬에서 삭제됨)

* **상황:** 팀원이 작업하던 브랜치를 로컬에서 삭제(`branch -D`)했고, `push`도 한 적이 없어 `reflog`에도 남아있지 않은 경우.
* **대응:**
    1.  `git fsck --lost-found` 명령어로 Git이 추적하던 "주인 없는" 객체(dangling commits)를 찾습니다.
    2.  출력된 커밋 해시들을 `git show [hash]`로 하나씩 확인하며 팀원이 작업하던 커밋을 찾습니다.
    3.  찾았다면 `git checkout -b dev/복구-브랜치 [hash]`로 복구합니다.
    4.  (최후의 수단이며, 찾지 못할 수도 있습니다.)
